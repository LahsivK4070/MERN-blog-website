{"ast":null,"code":"import _regeneratorRuntime from\"F:/web dev files/MERN Blog Website/back-end-blog-website/front-end-blog-website/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"F:/web dev files/MERN Blog Website/back-end-blog-website/front-end-blog-website/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"F:/web dev files/MERN Blog Website/back-end-blog-website/front-end-blog-website/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from'react';import{useContext}from'react';import\"./settings.css\";import{Context}from\"../../context/Context\";import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Settings=function Settings(){var _useContext=useContext(Context),user=_useContext.user,dispatch=_useContext.dispatch;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),file=_useState2[0],setFile=_useState2[1];var _useState3=useState(user.userName),_useState4=_slicedToArray(_useState3,2),userName=_useState4[0],setUsername=_useState4[1];var _useState5=useState(user.email),_useState6=_slicedToArray(_useState5,2),email=_useState6[0],setEmail=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),password=_useState8[0],setPassword=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),success=_useState10[0],setSuccess=_useState10[1];var PF=\"http://localhost:5000/images/\";var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){var updatedUser,data,fileName,res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();dispatch({type:\"UPDATE_START\"});updatedUser={userId:user._id,userName:userName,email:email,password:password};if(!file){_context.next=16;break;}data=new FormData();fileName=Date.now()+file.name;data.append(\"name\",fileName);data.append(\"file\",file);updatedUser.profilePic=fileName;_context.prev=9;_context.next=12;return axios.post(\"http://localhost:5000/api/upload/\",data);case 12:_context.next=16;break;case 14:_context.prev=14;_context.t0=_context[\"catch\"](9);case 16:_context.prev=16;_context.next=19;return axios.put(\"http://localhost:5000/api/user/\"+user._id,updatedUser);case 19:res=_context.sent;setSuccess(true);dispatch({type:\"UPDATE_SUCCESS\",payload:res.data});_context.next=27;break;case 24:_context.prev=24;_context.t1=_context[\"catch\"](16);dispatch({type:\"UPDATE_FAILURE\"});case 27:case\"end\":return _context.stop();}}},_callee,null,[[9,14],[16,24]]);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();var handleDelete=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return axios.delete(\"http://localhost:5000/api/posts/?user=\"+user.userName);case 3:_context2.next=5;return axios.delete(\"http://localhost:5000/api/user/\"+user._id,{data:{userId:user._id}});case 5:localStorage.setItem(\"user\",null);window.location.replace(\"/\");alert(\"Account deleted successfully\");_context2.next=13;break;case 10:_context2.prev=10;_context2.t0=_context2[\"catch\"](0);console.log(_context2.t0);case 13:case\"end\":return _context2.stop();}}},_callee2,null,[[0,10]]);}));return function handleDelete(){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"setting-component\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"setting-component-heading\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"setting-update\",children:\"Upadate Your Account\"}),/*#__PURE__*/_jsx(\"p\",{className:\"setting-delete\",onClick:handleDelete,children:\"Delete Account\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"setting-component-info\",children:[/*#__PURE__*/_jsx(\"img\",{src:file?URL.createObjectURL(file):PF+user.profilePic,className:\"setting-profile\",alt:\"setting-profile-img\"}),/*#__PURE__*/_jsx(\"div\",{className:\"setting-details\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"setting-img\",className:\"setting-img-label\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"setting-user fa-solid fa-user\"}),\" Change Profile\"]}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",name:\"settingImg\",onChange:function onChange(e){setFile(e.target.files[0]);},id:\"setting-img\",style:{display:\"none\"}}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"setting-name\",className:\"setting-name-label\",children:\"Username\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"userName\",id:\"setting-name\",placeholder:user.userName,onChange:function onChange(e){setUsername(e.target.value);},autoFocus:true}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"setting-email\",className:\"setting-email-label\",children:\"Email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",name:\"email\",id:\"setting-email\",placeholder:user.email,onChange:function onChange(e){setEmail(e.target.value);}}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"setting-password\",className:\"setting-pass-label\",children:\"Password\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",name:\"password\",required:true,id:\"setting-password\",onChange:function onChange(e){setPassword(e.target.value);}}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Update\"})]})}),success&&/*#__PURE__*/_jsx(\"span\",{style:{color:\"green\",textAlign:\"center\",marginTop:\"1rem\",fontSize:\"20px\",fontFamily:\"sans-serif\"},children:\"Successfully Updated\"})]})]});};export default Settings;","map":{"version":3,"names":["React","useState","useContext","Context","axios","Settings","user","dispatch","file","setFile","userName","setUsername","email","setEmail","password","setPassword","success","setSuccess","PF","handleSubmit","e","preventDefault","type","updatedUser","userId","_id","data","FormData","fileName","Date","now","name","append","profilePic","post","put","res","payload","handleDelete","delete","localStorage","setItem","window","location","replace","alert","console","log","URL","createObjectURL","target","files","display","value","color","textAlign","marginTop","fontSize","fontFamily"],"sources":["F:/web dev files/MERN Blog Website/back-end-blog-website/front-end-blog-website/src/components/settings/Settings.jsx"],"sourcesContent":["import React, {useState} from 'react'\r\nimport { useContext } from 'react';\r\nimport \"./settings.css\";\r\nimport { Context } from \"../../context/Context\";\r\nimport axios from 'axios';\r\n\r\nconst Settings = () => {\r\n\r\n  const { user, dispatch } = useContext(Context);\r\n  const [file, setFile] = useState(null);\r\n  const [userName, setUsername] = useState(user.userName);\r\n  const [email, setEmail] = useState(user.email);\r\n  const [password, setPassword] = useState(\"\");\r\n  const [success, setSuccess] = useState(false);\r\n\r\n  const PF = \"http://localhost:5000/images/\";\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    dispatch({ type: \"UPDATE_START\" });\r\n    const updatedUser = {\r\n      userId: user._id,\r\n      userName,\r\n      email,\r\n      password\r\n    };\r\n    if (file) {\r\n      const data = new FormData();\r\n      const fileName = Date.now() + file.name;\r\n      data.append(\"name\", fileName);\r\n      data.append(\"file\", file);\r\n      updatedUser.profilePic = fileName;\r\n      try {\r\n        await axios.post(\"http://localhost:5000/api/upload/\", data);\r\n      } catch (error) {\r\n        // TO DO\r\n      }\r\n    }\r\n    try {\r\n      const res = await axios.put(\"http://localhost:5000/api/user/\" + user._id, updatedUser);\r\n      setSuccess(true);\r\n      dispatch({type: \"UPDATE_SUCCESS\", payload: res.data})\r\n    } catch (error) {\r\n      dispatch({type: \"UPDATE_FAILURE\"})\r\n    }\r\n  }\r\n\r\n  const handleDelete = async () => {\r\n    try {\r\n      await axios.delete(\"http://localhost:5000/api/posts/?user=\" + user.userName);\r\n      await axios.delete(\"http://localhost:5000/api/user/\" + user._id, { data: { userId: user._id } });\r\n      localStorage.setItem(\"user\", null);\r\n      window.location.replace(\"/\");\r\n      alert(\"Account deleted successfully\");\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className='setting-component'>\r\n          <div className='setting-component-heading'>\r\n              <p className='setting-update'>Upadate Your Account</p>\r\n              <p className='setting-delete' onClick={handleDelete}>Delete Account</p>\r\n          </div>\r\n          <div className=\"setting-component-info\">\r\n              <img src={file ? URL.createObjectURL(file) : PF + user.profilePic} className='setting-profile' alt='setting-profile-img' />\r\n              <div className='setting-details'>\r\n                  <form onSubmit={handleSubmit}>\r\n                      <label htmlFor='setting-img' className='setting-img-label'><i className=\"setting-user fa-solid fa-user\"></i> Change Profile</label>\r\n            <input type=\"file\" name=\"settingImg\" onChange={(e) => { setFile(e.target.files[0]) }} id=\"setting-img\" style={{ display: \"none\" }} />\r\n                      <label htmlFor='setting-name' className='setting-name-label'>Username</label>\r\n                      <input type=\"text\" name=\"userName\" id=\"setting-name\" placeholder={user.userName} onChange={ (e)=> {setUsername(e.target.value)}} autoFocus={ true }/>\r\n                      <label htmlFor='setting-email' className='setting-email-label'>Email</label>\r\n                      <input type=\"email\" name=\"email\" id=\"setting-email\" placeholder={user.email} onChange={ (e)=> {setEmail(e.target.value)}}/>\r\n                      <label htmlFor=\"setting-password\" className='setting-pass-label'>Password</label>\r\n                      <input type=\"password\" name=\"password\" required={true} id=\"setting-password\" onChange={ (e)=> {setPassword(e.target.value)}}/>\r\n                      <button type=\"submit\">Update</button>\r\n                  </form>\r\n        </div>\r\n        {success && <span style={{color: \"green\", textAlign: \"center\", marginTop: \"1rem\", fontSize: \"20px\", fontFamily: \"sans-serif\"}}>Successfully Updated</span>}\r\n          </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Settings\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}