{"ast":null,"code":"import _toConsumableArray from\"F:/web dev files/MERN Blog Website/back-end-blog-website/front-end-blog-website/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _regeneratorRuntime from\"F:/web dev files/MERN Blog Website/back-end-blog-website/front-end-blog-website/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"F:/web dev files/MERN Blog Website/back-end-blog-website/front-end-blog-website/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"F:/web dev files/MERN Blog Website/back-end-blog-website/front-end-blog-website/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from'react';import{useContext}from'react';import\"./newPost.css\";import{Context}from\"../../context/Context\";import axios from\"axios\";import Tags from\"../tags/Tags\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Newpost=function Newpost(){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),title=_useState2[0],setTitle=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),desc=_useState4[0],setDesc=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),file=_useState6[0],setFile=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),tags=_useState8[0],setTags=_useState8[1];var _useContext=useContext(Context),user=_useContext.user;var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){var newPost,tag,res,data,fileName,_res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();if(!(title===\"\"||desc===\"\")){_context.next=5;break;}alert(\"Write Something first\");_context.next=38;break;case 5:newPost={userName:user.userName,title:title,desc:desc,category:tags};if(!tags){_context.next=16;break;}tag={name:tags};_context.prev=8;_context.next=11;return axios.post(\"http://localhost:5000/api/categories/\",tag);case 11:res=_context.sent;_context.next=16;break;case 14:_context.prev=14;_context.t0=_context[\"catch\"](8);case 16:if(!file){_context.next=29;break;}data=new FormData();fileName=Date.now()+file.name;data.append(\"name\",fileName);data.append(\"file\",file);newPost.photo=fileName;_context.prev=22;_context.next=25;return axios.post(\"http://localhost:5000/api/upload/\",data);case 25:_context.next=29;break;case 27:_context.prev=27;_context.t1=_context[\"catch\"](22);case 29:_context.prev=29;_context.next=32;return axios.post(\"http://localhost:5000/api/posts/\",newPost);case 32:_res=_context.sent;window.location.replace(\"/post/\"+_res.data._id);_context.next=38;break;case 36:_context.prev=36;_context.t2=_context[\"catch\"](29);case 38:case\"end\":return _context.stop();}}},_callee,null,[[8,14],[22,27],[29,36]]);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();function handleKeyDown(e){if(e.key!==\" \")return;var value=e.target.value;if(!value.trim())return;setTags([].concat(_toConsumableArray(tags),[value]));e.target.value='';}function removeTag(index){setTags(tags.filter(function(el,i){return i!==index;}));}return/*#__PURE__*/_jsxs(\"div\",{className:\"write-post\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"write-post-div\",children:file&&/*#__PURE__*/_jsx(\"img\",{src:URL.createObjectURL(file),alt:\"newPost-img\"})}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"newPost-file-div\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"newPost-img\",className:\"newPost-img-btn\",children:\"+\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",onChange:function onChange(e){setFile(e.target.files[0]);},name:\"newPost-img\",id:\"newPost-img\",style:{display:\"none\"}}),/*#__PURE__*/_jsx(Tags,{tags:tags,setTags:setTags,handleKeyDown:handleKeyDown,removeTag:removeTag})]}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",onChange:function onChange(e){setTitle(e.target.value);},className:\"write-title\",placeholder:\"Add title ...\",autoFocus:true}),/*#__PURE__*/_jsx(\"textarea\",{name:\"newPost-desc\",onChange:function onChange(e){setDesc(e.target.value);},id:\"newPost-desc\",cols:\"30\",rows:\"10\",placeholder:\"Write Something ...\"}),/*#__PURE__*/_jsx(\"button\",{className:\"submitPost\",type:\"submit\",children:\"Publish\"})]})]});};export default Newpost;","map":{"version":3,"names":["React","useState","useContext","Context","axios","Tags","Newpost","title","setTitle","desc","setDesc","file","setFile","tags","setTags","user","handleSubmit","e","preventDefault","alert","newPost","userName","category","tag","name","post","res","data","FormData","fileName","Date","now","append","photo","window","location","replace","_id","handleKeyDown","key","value","target","trim","removeTag","index","filter","el","i","URL","createObjectURL","files","display"],"sources":["F:/web dev files/MERN Blog Website/back-end-blog-website/front-end-blog-website/src/components/newPost/Newpost.jsx"],"sourcesContent":["import React, {useState} from 'react';\r\nimport { useContext } from 'react';\r\nimport \"./newPost.css\";\r\nimport { Context } from \"../../context/Context\";\r\nimport axios from \"axios\";\r\nimport Tags from \"../tags/Tags\";\r\n\r\nconst Newpost = () => {\r\n\r\n  const [title, setTitle] = useState(\"\");\r\n  const [desc, setDesc] = useState(\"\");\r\n  const [file, setFile] = useState(null);\r\n  const [tags, setTags] = useState([]);\r\n  const { user } = useContext(Context);\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    if (title === \"\" || desc === \"\") {\r\n      alert(\"Write Something first\");\r\n    } else {\r\n      const newPost = {\r\n        userName: user.userName,\r\n        title,\r\n        desc,\r\n        category: tags \r\n      };\r\n      if (tags) {\r\n        const tag = {\r\n          name: tags\r\n        };\r\n\r\n        try {\r\n          const res = await axios.post(\"http://localhost:5000/api/categories/\", tag);\r\n        } catch (error) {\r\n          \r\n        }\r\n      }\r\n      if (file) {\r\n        const data = new FormData();\r\n        const fileName = Date.now() + file.name;\r\n        data.append(\"name\", fileName);\r\n        data.append(\"file\", file);\r\n        newPost.photo = fileName;\r\n        try {\r\n          await axios.post(\"http://localhost:5000/api/upload/\", data);\r\n        } catch (error) {\r\n          // TO DO\r\n        }\r\n      }\r\n      try {\r\n        const res = await axios.post(\"http://localhost:5000/api/posts/\", newPost);\r\n        window.location.replace(\"/post/\" + res.data._id);\r\n      } catch (error) {\r\n        // TO DO\r\n      }\r\n    }\r\n  }\r\n\r\n    function handleKeyDown(e){\r\n        if(e.key !== \" \") return\r\n        const value = e.target.value\r\n        if(!value.trim()) return\r\n        setTags([...tags, value])\r\n        e.target.value = ''\r\n    }\r\n\r\n    function removeTag(index){\r\n        setTags(tags.filter((el, i) => i !== index))\r\n    }\r\n\r\n  return (\r\n    <div className='write-post'>\r\n      <div className='write-post-div'>\r\n          {file && <img src={URL.createObjectURL(file)} alt='newPost-img' />}\r\n      </div>\r\n      <form onSubmit={handleSubmit}>\r\n        <div className='newPost-file-div'>\r\n            <label htmlFor=\"newPost-img\" className='newPost-img-btn'>+</label>\r\n          <input type=\"file\" onChange={(e) => { setFile(e.target.files[0]) }} name=\"newPost-img\" id=\"newPost-img\" style={{ display: \"none\" }} /> \r\n          <Tags tags={tags} setTags={setTags} handleKeyDown={handleKeyDown} removeTag={ removeTag } />\r\n        </div>\r\n            <input type=\"text\" onChange={(e) => {setTitle(e.target.value)}} className='write-title' placeholder=\"Add title ...\" autoFocus={true} />\r\n            <textarea name=\"newPost-desc\" onChange={(e) => {setDesc(e.target.value)}} id=\"newPost-desc\" cols=\"30\" rows=\"10\" placeholder='Write Something ...'/>\r\n            <button className='submitPost' type='submit'>Publish</button>\r\n          </form>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Newpost;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}